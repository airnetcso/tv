<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kosa Kata Korea - Super Longgar</title>
    <style>
        body { font-family: Arial, sans-serif; background: #e8f5e9; margin: 0; padding: 10px; }
        .container { max-width: 100%; margin: auto; background: white; border-radius: 15px; padding: 25px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); }
        h1 { font-size: 26px; text-align: center; margin: 15px 0; color: #2e7d32; }
        input[type="text"] { width: 100%; padding: 20px; margin: 20px 0; font-size: 24px; border-radius: 12px; border: 3px solid #a5d6a7; box-sizing: border-box; text-align: center; }
        button { width: 100%; padding: 20px; margin: 12px 0; font-size: 22px; border-radius: 12px; border: none; color: white; font-weight: bold; cursor: pointer; }
        .btn-start { background: #4caf50; }
        .btn-next { background: #43a047; }
        .btn-submit { background: #2e7d32; }
        .btn-voice { background: #1976d2; font-size: 32px; padding: 30px; box-shadow: 0 6px 20px rgba(0,0,0,0.2); }
        .hidden { display: none; }
        #timer { text-align: center; font-size: 28px; color: #d50000; font-weight: bold; margin: 20px 0; background: #ffebee; padding: 10px; border-radius: 10px; }
        .progress { height: 12px; background: #c8e6c9; border-radius: 6px; margin: 20px 0; overflow: hidden; }
        .progress-bar { height: 100%; background: #4caf50; width: 0%; transition: width 0.4s; }
        .question strong { font-size: 36px; display: block; margin: 40px 0; color: #2e7d32; }
        .hint { font-size: 18px; color: #33691e; text-align: center; font-weight: bold; margin: 15px 0; }
        .wrong-list { font-size: 18px; line-height: 1.8; margin: 20px 0; background: #fff3e0; padding: 15px; border-radius: 10px; }
        .wrong-item { margin: 10px 0; }
    </style>
</head>
<body>
    <!-- Halaman sama seperti sebelumnya, aku skip biar nggak panjang, tapi script di bawah sudah diupdate -->
    <!-- ... (copy dari versi sebelumnya untuk HTML body) ... -->

    <script>
        // ... (speech recognition & variabel sama) ...

        // Sinonim diperluas banget!
        const synonyms = {
            "sayur": ["sayuran", "sayur-sayuran", "vegetable"],
            "ngantuk": ["mengantuk", "kantuk", "mengantuk banget"],
            "senang": ["bahagia", "gembira", "seneng", "senamg", "happy"],
            "lapar": ["kelaperan", "laper"],
            "haus": ["kehausan"],
            "malam": ["malem"],
            "satu": ["1"], "dua": ["2"], "tiga": ["3"], "empat": ["4"], "lima": ["5"],
            "halo": ["haloo", "hello", "hi", "helo"],
            "terima kasih": ["thanks", "makasih", "thank you", "trims"],
            "maaf": ["sorry", "mohon maaf", "maap"]
            // Tambah lagi kalau mau
        };

        function normalizeAnswer(answer) {
            let norm = answer.toLowerCase().trim().replace(/[^a-z0-9\s]/g, ''); // hapus tanda baca
            // Ganti sinonim
            for (const [key, vals] of Object.entries(synonyms)) {
                if (vals.some(v => norm.includes(v.toLowerCase()))) return key;
                if (norm.includes(key)) return key;
            }
            return norm;
        }

        function levenshtein(a, b) {
            // ... (sama seperti sebelumnya) ...
        }

        // Di submitQuiz, ganti toleransi jadi <= 3
        function submitQuiz() {
            // ... (sama) ...
            questions.forEach((q, i) => {
                const correct = (mode === 'koreaToIndo' ? q.indo : q.korea);
                const userAns = normalizeAnswer(userAnswers[i] || '');
                const distance = levenshtein(userAns, correct.toLowerCase());
                if (userAns && (userAns === correct.toLowerCase() || distance <= 3)) { // <= 3 huruf beda
                    score++;
                } else if (userAnswers[i]) {
                    // ... tambah ke wrongList ...
                }
            });
            // ... (sisa sama) ...
        }

        // ... (sisa script sama seperti versi sebelumnya) ...
    </script>
</body>
</html>
